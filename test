import subprocess
import time
from appium import webdriver
from appium.options.windows import WindowsOptions

# Start WinAppDriver
print("Starting WinAppDriver...")
subprocess.Popen([r"C:\Program Files (x86)\Windows Application Driver\WinAppDriver.exe"])
time.sleep(3)

# Define application path
app_path = r"C:\Path\To\RMS.exe"

# Setup Appium options
options = WindowsOptions()
options.app = app_path
options.platform_name = "Windows"
options.device_name = "WindowsPC"

# Connect to WinAppDriver
print("Launching RMS Application...")
driver = webdriver.Remote("http://127.0.0.1:4723", options=options)
time.sleep(3)

# === Perform Login Flow ===

# 1. Select Environment = UAT
env_dropdown = driver.find_element("accessibility id", "cmb_Environment")
env_dropdown.click()
time.sleep(1)
uat_option = driver.find_element("name", "UAT")  # Select item by visible text
uat_option.click()

# 2. Select Login Via = RMS
loginvia_dropdown = driver.find_element("accessibility id", "cmb_LoginVia")
loginvia_dropdown.click()
time.sleep(1)
rms_option = driver.find_element("name", "RMS")
rms_option.click()

# 3. Enter UserId
userid_box = driver.find_element("accessibility id", "txt_UserId")
userid_box.send_keys("myUserId")

# 4. Enter Password
password_box = driver.find_element("accessibility id", "txt_Password")
password_box.send_keys("myPassword")

# 5. Click Submit
submit_btn = driver.find_element("accessibility id", "btn_Submit")
submit_btn.click()

print("Login flow executed successfully.")

time.sleep(5)  # wait to see result

driver.quit()
print("Automation finished.")
