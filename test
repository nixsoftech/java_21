import time
from appium import webdriver
from appium.options.windows import WindowsOptions
from appium.webdriver.common.appiumby import AppiumBy

# -------------------------
# Launch RMS Application
# -------------------------
options = WindowsOptions()
options.platform_name = "Windows"
options.device_name = "WindowsPC"
options.app = r"C:\Path\To\RMS.exe"   # <-- update with your RMS.exe path

driver = webdriver.Remote(
    command_executor="http://127.0.0.1:4723",
    options=options
)

time.sleep(3)  # wait for app to load fully

# -------------------------
# Interact with Login Form
# -------------------------

# 1. Select environment (UAT)
env_dropdown = driver.find_element(AppiumBy.ACCESSIBILITY_ID, "cmbEnvironment")  # update with Inspect ID
env_dropdown.click()
time.sleep(1)
uat_option = driver.find_element(AppiumBy.NAME, "UAT")
uat_option.click()

# 2. Enter username
username_box = driver.find_element(AppiumBy.ACCESSIBILITY_ID, "txtUsername")  # update with Inspect ID
username_box.clear()
username_box.send_keys("testuser")

# 3. Enter password
password_box = driver.find_element(AppiumBy.ACCESSIBILITY_ID, "txtPassword")  # update with Inspect ID
password_box.clear()
password_box.send_keys("P@ssw0rd")

# 4. Click login button
login_btn = driver.find_element(AppiumBy.NAME, "Login")  # update with Inspect Name or AutomationId
login_btn.click()

print("âœ… Login flow completed via WinAppDriver")
