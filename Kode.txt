safe_click(peak_margin_win, title="Save", control_type="Button")
    time.sleep(2)
    logger.info("Clicked Save, waiting for confirmation popup...")

    try:
        popup = app.window(best_match="Risk Management System")
        popup.wait("visible", timeout=10)

        try:
            popup_text = popup.child_window(auto_id="65535", control_type="Text").window_text()
            logger.info(f"Popup message: {popup_text}")
        except Exception:
            logger.warning("Popup text control not found, proceeding with OK click.")

        safe_click(popup, auto_id="2", control_type="Button")
        logger.info("Clicked OK on confirmation popup.")
    except Exception as e:
        logger.error(f"Failed to handle confirmation popup: {e}")
        raise

    logger.info("Row filled, saved, and popup confirmed successfully.")
