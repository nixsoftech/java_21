def dump_peak_margin_complete_fixed(peak_margin_win, expected_columns=8):
    """
    Dump Peak Margin grid and reconstruct rows by fixed column count.
    Returns list of tuples: (row_cells, row_values)
    """
    tables = peak_margin_win.descendants(control_type="Table") + peak_margin_win.descendants(control_type="List")
    if not tables:
        logger.warning("No tables/list views found in Peak Margin window")
        return []

    grid = tables[0]
    all_cells = grid.descendants(control_type="DataItem")
    rows = []

    for i in range(0, len(all_cells), expected_columns):
        row_cells = all_cells[i:i+expected_columns]
        row_values = []
        for cell in row_cells:
            try:
                val = cell.legacy_properties().get("Value", "") or cell.window_text() or ""
            except Exception:
                val = ""
            row_values.append(val.strip() if val else "")
        rows.append((row_cells, row_values))

    # Log for debugging
    for idx, (_, values) in enumerate(rows):
        logger.info(f"Row {idx}: {values}")

    return rows
