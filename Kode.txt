def set_cell_value(cell, value, max_attempts=3):
    """Safely sets a value in a grid cell with retries."""
    from pywinauto.keyboard import send_keys
    for attempt in range(1, max_attempts + 1):
        try:
            cell.click_input(double=False)
            cell.type_keys("{F2}")
            time.sleep(0.3)
            send_keys("^a{BACKSPACE}", pause=0.05)
            send_keys(value, pause=0.05)
            send_keys("{ENTER}", pause=0.05)
            time.sleep(0.3)
            return
        except Exception as e:
            logger.warning(f"Attempt {attempt} failed to set value '{value}': {e}")
            time.sleep(0.5)
    raise TimeoutError(f"Failed to set value '{value}' after {max_attempts} attempts")
